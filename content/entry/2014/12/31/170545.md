+++
Categories = ["SSH", "ポートフォワード", "インフラ"]
Description = " SSHは奥が深い。ローカルポートフォワードの使い方を実例を含めて解説する。"
Tags = ["tech"]
date = "2014-12-31T17:05:00+09:00"
title = "SSHでローカルポートフォワードを実際に試す"
author = "mosuke5"
archive = ["2014"]
draft = false
+++

<body>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/SSH">SSH</a>・・・<br>
いろんなことができる"らしい"ということは知っていたし、<br>
例えばポートフォワーディングなんていうこともできるのも知っている。</p>

<p>でもそれがどんなものなのか自分の手で試したことはないし、<br>
なんとなくただのサーバログイン<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C4%A1%BC%A5%EB">ツール</a>として利用していた。</p>

<p>サーバインフラ技術に興味を持つようになっていろんなことを勉強していると、<br>
ポートフォワーディングは必須な技術であることも感じ、<br>
年末の持て余す時間を使って<a class="keyword" href="http://d.hatena.ne.jp/keyword/SSH">SSH</a>のローカルポートフォワードを試してみたのでメモする。</p>

<h1>環境とやりたいこと</h1>

<p><span itemscope itemtype="http://schema.org/Photograph"><img src="/image/20141231162958.png"></span></p>


<p>ローカルPCからexample.jpは以下で接続できる状態。</p>

```
[local pc] $ ssh username@example.jp 
```


<p>またWebサーバのポート番号は80で、<a class="keyword" href="http://d.hatena.ne.jp/keyword/VPS">VPS</a>のホストサーバからはWebサーバへ接続できる。<br>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/CUI">CUI</a>なのでわかりづらいが<a class="keyword" href="http://d.hatena.ne.jp/keyword/curl">curl</a>を打つと<a class="keyword" href="http://d.hatena.ne.jp/keyword/Hello%20World">Hello World</a>が返ってきている。</p>

```
[example.jp] $ curl 192.168.33.10
<html><body><h1>Hello World! Virtual Web Server</h1>
</body></html> 
```


<h1>ローカルポートフォワードの実行</h1>

<p>ローカルPCから以下を実行する。<br>
以下のコマンドは、<br>
<b>ローカルPCのポート8888での接続はexample.jpからみて「192.168.33.10のポート80」に飛ばす</b><br>
といったもの。</p>

```
[local pc] $ ssh -L8888:192.168.33.10:80 username@example.jp 
```


<p>この状態でブラウザから<code>http://localhost:8888</code>にアクセスすると<br>

<p>なんと、ローカルホストにつないだはずが、example.jp上の仮想Webサーバのhtmlがうつっているではないか…</p>

<p><span itemscope itemtype="http://schema.org/Photograph"><img src="/image/20141231163932.png"></span></p>


<h1>セキュリティはどうなの？</h1>

<p>ローカルの端末からhttpで仮想のWebサーバに接続しているけど、セキュリティはだいじょうぶなのだろうか？<br>
http通信だから暗号化はされていないのだろうか？<br>
なんて疑問もあるが、それは問題ない。</p>

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/SSH">SSH</a>でローカルPCから<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%EA%A5%E2%A1%BC%A5%C8%A5%DB%A5%B9%A5%C8">リモートホスト</a>(example.jp)までトンネルをはり、<br>
そのなかをhttpで通信しているから全く問題なしといえる。</p>

<p>ローカルポートフォワードを利用する場合は、おそらく表には出したくないけど、<br>
ローカルから接続したいなどの要件の時に使うと思うけど、<a class="keyword" href="http://d.hatena.ne.jp/keyword/SSH">SSH</a>できちんと暗号化しているので安心。</p>

<h1>最後に</h1>

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/SSH">SSH</a>でできることはこの他にもたくさんある。<br>
ポートフォワードだけみても他にも「リモートポートフォワード」や「ダイナミックポートフォワード」などがある。<br>
リモートポートなどはいまぱっと試せる環境がなかったのでおいおい実践してみる…</p>

<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/SSH">SSH</a>をただのログイン<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C4%A1%BC%A5%EB">ツール</a>だけに留めるのは今年で終わりにしよう…</p>
</body>
