+++
Categories = ["インフラ構築"]
Description = "エンタープライズのシステム運用担当が知っておくべき、ネットワークの知識・キーワードをお伝えします。主に、VLAN、ゲートウェイ冗長化などシステムサイドとして馴染みの薄い観点で紹介します。"
Tags = ["tech"]
date = "2014-03-09T21:25:00+09:00"
title = "システム担当者が知るべきエンタープライズシステムのネットワーク構成"
author = "mosuke5"
archive = ["2014"]
draft = false
+++

こんにちは。もーすけです。  
本ブログでは、オンプレミス環境でエンタープライズシステムの運用を担当している初心者向けのネットワーク知識の勘所をお伝えするものです。
わたしは、学生の頃にWebアプリケーションの開発などのシステム開発に携わっており、その後にモバイル通信キャリアのエンタープライズシステムの開発・運用を担当しました。オンプレミスの環境でのシステムであり、システム担当者といえ最低限ネットワークの知識も必要でした。

世の中のネットワークの書籍や情報では、ネットワークエンジニア向けの情報が多く、それぞれの技術の詳細についての情報はたくさんあります。一方で、業務としてシステム担当が知っておくべきネットワークの情報の関連性などに関する情報は非常に少ないです。
実践的な構成例を元に、システム担当者が知っておくべきネットワークの情報をまとめました。
<!--more-->

## 役割分担
ネットワーク担当とシステム担当でよく役割分担されることが多いです。
この分担でネットワーク担当が責務をもつのはバックボーンネットワークであることが多く、システム担当もL3ルーター（L3スイッチ）からサーバまでの間のネットワークについては責任を持つことが多いです。
もちろん、システム規模にもよって更に担当が別れたりしますが、多くの企業を見ていてこのようなケースも少なくありません。

- ネットワーク担当: 企業内のバックボーンネットワークの構築と運用
- システム担当: システムが利用するサーバ群に関わるネットワークの構築と運用

## 構成のポイント
エンタープライズシステムでよくみるシステム構成(かなり簡素化した構成)を以下に示します。
この例をもとに、システムを安定稼働するために最低限知っておくべきことを考えていきます。

![vlan-trunk](/image/vlan_trunk.jpg)

### NIC冗長（チーミング）
まずは、サーバのネットワークから見ていきます。
オンプレミスの環境では物理的なケーブルや物理NICが故障する可能性もあります。
そのため、チーミングなどの技術を用いてNICの冗長化を実現します。
接続先のスイッチが落ちることもあるので、接続先は複数のスイッチに接続することが王道です。

チーミングについての詳しい内容や実装方法については以下を是非参考にしましょう。
上の図を見た上でチーミングを内容をみると理解しやすいともしれません。

<a href="https://www.infraexpert.com/study/etherchannel1.html" target="_blank">チーミングとは</a>

### VLANによるネットワーク分離
１つのネットワーク（L3スイッチの配下）に複数のシステムがぶらさがることも多くあります。
図でいうと、左下の緑の線でつながっているサーバ群と右下のピンクの線で繋がれているサーバ群が別のシステムという場合です。

この場合にVLANは非常に役に立ちます。  
同じスイッチにつながっていますがネットワークとして分離したいことは多くあります。
主に以下のようなメリットを出したくVLANを使います。クラウド環境ではこんなこと考えなくてすむわけですが、まだまだオンプレ環境も多い環境ではやはり重要です。  
また、VLANを作っていく上で、トランクというキーワードもよくでてきます。
トランクは複数のスイッチをまたいでVLANを構築する際に必要となる概念です。

- ブロードキャストの増加を防ぐ
- セキュリティの向上
- スイッチの有効活用


### L3SW、ゲートウェイの冗長化
最後にゲートウェイの冗長化です。  
ゲートウェイの一番代表的なところで言うとデフォルトゲートウェイです。サーバには、自動であれ手動であれデフォルトゲートウェイを設定します。
そのゲートウェイをどう冗長化するかも悩ましいポイントです。
サーバ側でゲートウェイを切り替えるということは基本的にしたくありません。障害の復旧を長引かせてしまうだけです。
サーバからみてゲートウェイのアドレスは変わらないが、冗長化できている必要があります。
Ciscoの機器ならばHSRPというプロトコルを利用してゲートウェイの冗長化をよく行っていました。
どちかがアクティブなゲートウェイかを判断するためのHelloパケットをL2スイッチ経由で通すことで、実際のサーバからの通信経路の正常性を確認しつつ判断できます。

<div class="iframely-embed"><div class="iframely-responsive" style="height: 140px; padding-bottom: 0;"><a href="http://kazunetproject.site/910/" data-iframely-url="//cdn.iframe.ly/X2IjB4x?iframe=card-small"></a></div></div><script async src="//cdn.iframe.ly/embed.js" charset="utf-8"></script>

## さいごに
システム運用者目線での、システムを安定稼働させるためのネットワークについてみてきました。
自分が実際にシステム担当として必要なネットワークの知識を俯瞰して理解することに困ったので少しでもみなさんの参考になればと思います。
DXなどといわれるようになり、今まで外注任せにしていたシステムを自分の手で読み解いて運用していくことも多いのではないでしょうか。